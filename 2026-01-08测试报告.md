# VQAv2 Balanced V3 测试报告

> 日期：2026-01-08
> 项目：Lever-Plus VQAv2 数据平衡实验

---

## 一、实验概述

通过筛选正负样本比例在 40%-60% 之间的 query，生成平衡的 RL 训练数据，验证数据量对模型效果的影响。

---

## 二、数据统计

| 版本 | Queries 数量 | Candidates 数量 | 正样本比例 |
|------|-------------|-----------------|-----------|
| Balanced V2 | 1,894 | - | 50.9% |
| Balanced V3 (第一轮) | 2,809 | 56,180 | 50.8% |
| Balanced V3 (第二轮) | 3,908 | 78,160 | 50.8% |

---

## 三、评估结果

### 3.1 Baseline（Balanced V2，1894 queries，1000 samples）

| Shot | 准确率 |
|------|--------|
| **1** | 69.01% |
| **2** | 66.11% |

### 3.2 Balanced V3 第一轮（2809 queries，1000 samples）

| Shot | Baseline | Balanced V3 | 提升 |
|------|----------|-------------|------|
| **1** | 69.01% | **74.58%** | **+5.57%** ⬆️ |
| **2** | 66.11% | **72.03%** | **+5.92%** ⬆️ |
| **3** | - | 72.03%* | - |
| **4** | - | 72.03%* | - |

*注：Shot 3/4 因 K=2 限制，实际只选择了 2 个示例，与 Shot 2 结果相同。

### 3.3 历史结果对比（800 samples）

| 日期 | 模型版本 | Shot 1 | Shot 2 | Shot 3 | Shot 4 |
|------|---------|--------|--------|--------|--------|
| 01-04 | Balanced V2 Epoch 1 | 69.35% | 65.17% | 63.19% | 62.70% |
| 01-04 | Balanced V2 Epoch 1 | 70.03% | 63.42% | 61.86% | 61.05% |
| 01-07 | **Balanced V3 Epoch 1** | **74.58%** | **72.03%** | 72.03% | 72.03% |

### 3.4 关键发现

1. **数据量增加带来显著提升**：
   - 从 1894 queries 增加到 2809 queries（+48%）
   - Shot 1 准确率从 69.01% 提升到 74.58%（+5.57%）
   - Shot 2 准确率从 66.11% 提升到 72.03%（+5.92%）

2. **正负样本比例 ~50% 是有效的**：
   - 两个版本的正样本比例都在 50% 左右
   - 效果提升主要来自数据量增加

3. **Shot 3/4 受限于 K=2**：
   - 模型候选池大小 K=2，只能选择 2 个示例
   - Shot 3/4 实际只使用了 2 个示例，与 Shot 2 结果相同

---

## 四、后续计划

1. 继续生成更多平衡数据（目标：10000+ queries）
2. 验证数据量增加是否能继续提升效果
3. 考虑增大 K 值以支持更多 shot

---

## 五、训练配置

```yaml
# Balanced V3 训练配置
RL_DATA: rl_data_balanced_merged.json
SFT_CKPT: Qwen2_5_VL_3B_Instruct_RandSampler_infoscore_left_beam5_shot2_cand64_sample5000_epoch=17
RCE_EPOCHS: 5
GRPO_EPOCHS: 30
KL_BETA: 0.1
GRPO_LR: 5e-6
REWARD_MODE: hard_plus_soft
```

---

## 六、结论

**正负样本比例 ~50% + 更多数据 = 更好的效果**

数据量从 1894 增加到 2809（+48%），准确率提升约 5.5-6%，说明：
1. 当前的数据筛选策略是有效的
2. 继续增加数据量有望进一步提升效果
